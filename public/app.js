(()=>{"use strict";class t{constructor(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),t.appendChild(this.canvas),this.fitToContainer=this.fitToContainer.bind(this),this.fitToContainer(this.canvas),addEventListener("resize",(()=>this.fitToContainer(this.canvas)))}fitToContainer(t){this.w=this.canvas.width=t.offsetWidth,this.h=this.canvas.height=t.offsetHeight}}class e{constructor(t,e){this.update=t,this.display=e,this.deltaTime=0,this.lastUpdate=0,this.maxInterval=40,this.payse=!1,this.stop=!1,this.start=!1,this.animate=this.animate.bind(this),this.animate()}animate(t=0){this.start=requestAnimationFrame(this.animate),this.deltaTime=t-this.lastUpdate,this.deltaTime<this.maxInterval&&(this.update(this.deltaTime/1e3),this.display()),this.lastUpdate=t}stopGame(){cancelAnimationFrame(this.start)}}class i{constructor({x:t,y:e,w:i,h:s,vx:h,vy:r}){this.rect={x:t||0,y:e||0,w:i||32,h:s||32,vx:h||500,vy:r||500}}update(t,e){(this.rect.x<=0&&this.rect.vx<0||this.rect.x+this.rect.w>t.w&&this.rect.vx>0)&&(this.rect.vx=-this.rect.vx),(this.rect.y<=0&&this.rect.vy<0||this.rect.y+this.rect.h>t.h&&this.rect.vy>0)&&(this.rect.vy=-this.rect.vy),this.rect.x+=this.rect.vx*e,this.rect.y+=this.rect.vy*e}}class s extends i{constructor(){super({}),this.joystick={KeyW:!1,KeyS:!1,KeyA:!1,KeyD:!1},window.onkeydown=function(t){this.keyDown(t)}.bind(this),window.onkeyup=function(t){this.keyUp(t)}.bind(this)}update(t,e){this.move(e),this.colliderField(t)}keyDown(t){this.joystick.hasOwnProperty(t.code)&&(this.joystick[t.code]=!0)}keyUp(t){this.joystick.hasOwnProperty(t.code)&&(this.joystick[t.code]=!1)}move(t){this.joystick.KeyW&&(this.rect.y+=-this.rect.vy*t),this.joystick.KeyS&&(this.rect.y+=this.rect.vy*t),this.joystick.KeyA&&(this.rect.x+=-this.rect.vx*t),this.joystick.KeyD&&(this.rect.x+=this.rect.vx*t)}colliderField(t){this.rect.x<0&&(this.rect.x=0),this.rect.x+this.rect.w>t.w&&(this.rect.x=t.w-this.rect.w),this.rect.y<0&&(this.rect.y=0),this.rect.y+this.rect.h>t.h&&(this.rect.y=t.h-this.rect.h)}}class h{constructor(h){this.layer=new t(h),this.rect=new i({}),this.rect2=new i({x:99,y:99,w:30,h:30,vx:50,vy:50}),this.i=0,this.player=new s,this.loop=new e(this.update.bind(this),this.display.bind(this))}update(t){this.rect.update(this.layer,t),this.rect2.update(this.layer,t),this.player.update(this.layer,t),(this.player.rect.y<=this.rect2.rect.y+this.rect2.rect.h&&this.player.rect.y>=this.rect2.rect.y&&this.player.rect.x<=this.rect2.rect.x+this.rect2.rect.w&&this.player.rect.x>=this.rect2.rect.x||this.player.rect.y+this.player.rect.h>=this.rect2.rect.y&&this.player.rect.y<=this.rect2.rect.y+this.rect2.rect.h&&this.player.rect.x+this.player.rect.w>=this.rect2.rect.x&&this.player.rect.x<=this.rect2.rect.x+this.rect2.rect.w)&&(this.loop.stopGame(),console.log("Game over"))}display(){this.layer.context.clearRect(0,0,this.layer.w,this.layer.h),this.layer.context.fillStyle="orange",this.layer.context.fillRect(this.rect.rect.x,this.rect.rect.y,this.rect.rect.w,this.rect.rect.h),this.layer.context.fillStyle="green",this.layer.context.fillRect(this.rect2.rect.x,this.rect2.rect.y,this.rect2.rect.w,this.rect2.rect.h),this.layer.context.fillStyle="blue",this.layer.context.fillRect(this.player.rect.x,this.player.rect.y,this.player.rect.w,this.player.rect.h)}}onload=function(){new h(document.querySelector("body"))}})();